<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>International iBCI Patient Registry</title>

  <!-- Bootstrap CSS (CDN) -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    integrity="sha384-ENjdO4Dr2bkBIFxQ2ZbMLZ12zYggK3Z1IdLGEm3Et3gq1vCIX9NtP2ImGpH6yJI6"
    crossorigin="anonymous"
  />

  <!-- In-line CSS -->
  <style>
    /* GENERAL STYLING */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* NAVBAR OVERRIDES (OPTIONAL) */
    .navbar-brand {
      font-weight: bold;
      font-size: 1.3rem;
    }

    /* TABLE STYLING */
    .table th,
    .table td {
      vertical-align: middle;
      text-align: center;
    }

    /* FOOTER STYLES */
    .footer {
      margin-top: auto;
    }
  </style>
</head>

<body>
  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">International iBCI Patient Registry</a>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="container mb-5">
    <!-- Search Section -->
    <div class="row mb-3">
      <div class="col-12 col-md-6">
        <input
          type="text"
          id="searchInput"
          class="form-control"
          placeholder="Search by patient ID, device, lab, or publication..."
          onkeyup="filterTable()"
        />
      </div>
    </div>

    <!-- Table Section -->
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle" id="ibciTable">
        <thead class="table-dark">
          <tr>
            <th scope="col">Patient ID</th>
            <th scope="col">Device Type</th>
            <th scope="col">Lab / Institution</th>
            <th scope="col">Publications</th>
          </tr>
        </thead>
        <tbody id="ibciTableBody">
          <!-- Rows populated by JavaScript -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer bg-dark text-center text-white py-3">
    <p class="mb-0">Created by Jamie Brannigan and Esmee Dohle</p>
  </footer>

  <!-- Bootstrap JS (CDN) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-5ZkYMNC6u+Jyda3/Yo60il0Z6V4UVpPE9q5k5tY/2D0/gHg+5X6xQ7MfYwR9a6RJ"
    crossorigin="anonymous"
  ></script>

  <!-- In-line JavaScript -->
  <script>
    // ==============
    // Data Section
    // ==============
    const ibciPatients = [
      {
        patientID: "P1",
        deviceType: "Utah Array",
        lab: "BrainGate Consortium",
        publications: [
          {
            title: "Neuronal ensemble control of prosthetic devices...",
            link: "https://www.nature.com/articles/nature07479"
          },
          {
            title: "High-performance communication by people with paralysis...",
            link: "https://elifesciences.org/articles/18554"
          }
        ]
      },
      {
        patientID: "P2",
        deviceType: "ECoG Grid",
        lab: "Grenoble University",
        publications: [
          {
            title: "Fully Implanted Brainâ€“Computer Interface in a Locked-In Patient...",
            link: "https://www.nejm.org/doi/10.1056/NEJMoa1608085"
          }
        ]
      },
      {
        patientID: "P3",
        deviceType: "Endovascular Stentrode",
        lab: "Synchron / Melbourne",
        publications: [
          {
            title: "Endovascular motor neuroprosthesis for severe paralysis...",
            link: "https://jnis.bmj.com/content/13/2/102"
          }
        ]
      }
      // You can add or remove entries here as needed
    ];

    // ==============
    // Script Section
    // ==============

    // Populate table on window load
    window.onload = function() {
      populateTable();
    };

    // Dynamically populate the table with ibciPatients data
    function populateTable() {
      const tableBody = document.getElementById("ibciTableBody");
      tableBody.innerHTML = "";

      ibciPatients.forEach((patient) => {
        const row = document.createElement("tr");

        // Patient ID cell
        const patientCell = document.createElement("td");
        patientCell.textContent = patient.patientID;
        row.appendChild(patientCell);

        // Device Type cell
        const deviceCell = document.createElement("td");
        deviceCell.textContent = patient.deviceType;
        row.appendChild(deviceCell);

        // Lab/Institution cell
        const labCell = document.createElement("td");
        labCell.textContent = patient.lab;
        row.appendChild(labCell);

        // Publications cell
        const pubCell = document.createElement("td");
        if (patient.publications && patient.publications.length > 0) {
          const ul = document.createElement("ul");
          patient.publications.forEach((pub) => {
            const li = document.createElement("li");
            const anchor = document.createElement("a");
            anchor.href = pub.link;
            anchor.target = "_blank";
            anchor.rel = "noopener noreferrer";
            anchor.textContent = pub.title;
            li.appendChild(anchor);
            ul.appendChild(li);
          });
          pubCell.appendChild(ul);
        } else {
          pubCell.textContent = "N/A";
        }
        row.appendChild(pubCell);

        // Add row to table
        tableBody.appendChild(row);
      });
    }

    // Filter table rows based on user input
    function filterTable() {
      const input = document.getElementById("searchInput");
      const filter = input.value.toLowerCase();
      const tableBody = document.getElementById("ibciTableBody");
      const rows = tableBody.getElementsByTagName("tr");

      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const cells = row.getElementsByTagName("td");
        let match = false;

        for (let j = 0; j < cells.length; j++) {
          const cellValue = cells[j].textContent.toLowerCase();
          if (cellValue.indexOf(filter) > -1) {
            match = true;
            break;
          }
        }
        row.style.display = match ? "" : "none";
      }
    }
  </script>
</body>
</html>
